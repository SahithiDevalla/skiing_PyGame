(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{1013:function(e,a,t){},1073:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(127),i=t(176),s=t(1),o=t(111),c=t.n(o),m=t(146),d=(t(1013),t(328));const u=({selectedImage:e=-1,data:a={},imageObj:t={},handleImageObjSelection:n=(()=>{}),handleSelection:r=(()=>{}),handleInsertMedia:i=(()=>{})})=>{if(a&&a.results&&e>-1&&e<a.count){const s=a.results[e];return l.a.createElement("div",{className:`mediaDialog-card__info ${e>-1?"show":""}`},l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("strong",null,"Filename"),l.a.createElement("span",null,s.filename))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("strong",null,"Uploaded By"),l.a.createElement("span",null,s.uploaded_by))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("strong",null,"Uploaded On"),l.a.createElement("span",null,new Date(s.date_created).toLocaleString()))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("strong",null,"Mime Type"),l.a.createElement("span",null,s.mime_type))),["audio","video"].indexOf(s.media_type)<=-1&&l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("strong",null,"Dimension"),l.a.createElement("span",null,s.width,"x",s.height))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("strong",null,"URL"),l.a.createElement("div",{style:{display:"flex",alignItems:"center"}},l.a.createElement("a",{rel:"noreferrer",href:`${s.original.src}`,target:"_blank"},s.filename),l.a.createElement("i",{className:"editor-icon external-link"})))),["audio","video"].indexOf(s.media_type)<=-1&&l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("strong",null,"Select size"),l.a.createElement("div",{className:"display-settings"},l.a.createElement("select",{defaultValue:`${s.width}-${s.height}`,onChange:n},l.a.createElement("option",{value:-1,key:-1},"Select"),s.dimensions&&s.dimensions.map((e,a)=>l.a.createElement("option",{value:a,key:a},e.width,"x",e.height))),l.a.createElement("span",{className:"ml-2"},l.a.createElement("a",{target:"_blank",rel:"noreferrer",href:`${s.image_url}${t&&!c.a.isEmpty(t)?t.filename:s.filename}`},"Link"))))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("button",{onClick:()=>r(-1),className:"secondary-button secondary-button__sm insertPost ml-1"},"Close"),l.a.createElement("button",{className:"primary-button primary-button__sm insertPost",onClick:e=>{e.preventDefault(),i()}},"Insert Into Post"))))))}return l.a.createElement("div",{className:`mediaDialog-card__info ${e>-1?"show":""}`})};u.propTypes={selectedImage:s.PropTypes.number,data:s.PropTypes.object,imageObj:s.PropTypes.object,handleImageObjSelection:s.PropTypes.func,handleSelection:s.PropTypes.func,handleInsertMedia:s.PropTypes.func};var p=u,g=t(288);const b=({data:e={},isLoading:a,isFetching:t,isError:i,onClose:s=(()=>{})})=>{const{editor:o}=Object(n.useContext)(r.a),[m,d]=Object(n.useState)(-1),[u,b]=Object(n.useState)({});Object(n.useEffect)(()=>()=>{d(-1),b({})},[e]);const E=a=>{let t=-1;m!==a&&(t=a),d(t);let n={};if(-1!==t){let{width:a,height:l,filename:r}=e.results[t];n={width:a,height:l,filename:r}}b({...n})};return l.a.createElement("div",{className:"mediaDialog-body"},l.a.createElement("div",{className:"mediaDialog__row"},e&&e.results&&e.results.map((e,a)=>{const t=["audio","video"].indexOf(e.media_type)<=-1?`${e.image_url}${e.filename}`:e.defaultImage;return l.a.createElement("div",{onClick:()=>E(a),key:a,className:"mediaDialog__column"},l.a.createElement("div",{className:`mediaDialog-card ${m===a?"selected":""}`},l.a.createElement("img",{alt:e.filename,src:t})))}),(a||t)&&c.a.times(12,e=>l.a.createElement("div",{key:e,className:"mediaDialog__column"},l.a.createElement("div",{className:"mediaDialog-card"},l.a.createElement("div",{className:"img-block"})))),(!t||!a)&&e.count<=0&&l.a.createElement("div",{className:"data__notFound"},l.a.createElement("p",null,"No Media Found"),l.a.createElement("img",{width:200,src:"/assets/not_found.svg",alt:"Not found"})),i&&!(a||t)&&l.a.createElement("div",{className:"data__notFound"},l.a.createElement("p",null,"Some error occurred, try again"),l.a.createElement("img",{width:200,src:"/assets/server_error.svg",alt:"Error occurred"}))),l.a.createElement(p,{data:e,selectedImage:m,imageObj:u,handleImageObjSelection:a=>{let t=a.target.value;m>-1&&e&&e.results&&b(e&&e.results&&e.results[m].dimensions[t])},handleSelection:E,handleInsertMedia:()=>{const a=e.results[m>-1?m:0];["image","gif"].includes(a.media_type)?o.dispatchCommand(g.a,{src:a.image_url&&u.filename&&a.image_url+u.filename||a.original.src,srcset:c.a.map(a.dimensions,(e,t)=>`${a.image_url}${e.filename} ${e.width}w`),altText:a.filename.replace(/\.[^.\s]+$/,""),maxWidth:a.width,width:u.width||a.width,height:u.height||a.height,media_type:a.media_type}):o.dispatchCommand(g.a,{url:a.original.src,media_type:a.media_type}),s()}}))};b.propTypes={data:s.PropTypes.object,isLoading:s.PropTypes.bool,isFetching:s.PropTypes.bool,isError:s.PropTypes.bool,onClose:s.PropTypes.func};var E=b;var h=t(325);const f=e=>new Promise((a,t)=>{let n=new Image;n.onload=(()=>a(n.width)),n.onerror=t,n.src=e});var y=(e=[])=>{const[a,t]=Object(n.useState)(null),[l,r]=Object(n.useState)(null),[i,s]=Object(n.useState)(!1),[o,c]=Object(n.useState)(!1),[m]=Object(d.b)(),u=async e=>{const a=await(async(e=[])=>{let a=new FormData,t={error:!1,message:""};for(let n=0;n<e.length;n++){let l=e[n],{size:r,name:i,type:s}=l;const o=s.split("/");let c=o[0],m=o[1];switch(c){case"image":if("gif"!=m){if(r>2e5){t.error=!0,t.message+=`${i} exceeds the maximum upload size(200KB) for image.<br />`;continue}if(await f(window.URL.createObjectURL(e[n]))>1100){t.error=!0,t.message+=`${i} exceeds the maximum upload width(1100px) for image.<br />`;continue}}break;case"video":if("quicktime"===m){t.error=!0,t.message+=`${m} format of video file ${i} is not allowed. Please upload either of 'mp4', 'webm' formats only.<br />`;continue}break;case"audio":break;default:t.error=!0,t.message=`${c||"file"} is not a supported media type. Please upload image, video or audio file only.<br />`;continue}r>3e8&&(t.error=!0,t.message+=`${i} exceeds the maximum upload size(300MB).<br />`),a.append(c+n+"",l)}return[t,a]})(e);if(a[0].error)throw new Error(a[0].message);return a[1]};return Object(n.useEffect)(()=>(e&&e.length&&(s(!0),u(e).then(async e=>{const a=await m({data:e}).unwrap();t(a),c(!0)}).catch(e=>{t(null),r(e.message||"Some error occurred, try again")}).finally(()=>{s(!1)})),()=>{t(null),r(null),c(!1),s(!1)}),[e]),{media:a,isErrorMedia:l,isUploadingMedia:i,isSuccessMedia:o}},v=t(334);const _=({enableUpload:e=!0,enableEmbedLink:a=!0,onClose:t=(()=>{})})=>{let i="";const[s,o]=Object(n.useState)({search:"",media_type:""}),[u,p]=Object(n.useState)(null),{media:b,isUploadingMedia:f,isErrorMedia:_}=y(u),[w,k]=Object(n.useState)({}),{data:j,isLoading:O,isFetching:N,isError:C}=Object(v.c)(e=>d.a.endpoints.getMediaRows.select(s)(e)),x=Object(v.b)(),S=Object(n.useRef)(),{editor:$}=Object(n.useContext)(r.a),P=Object(n.useCallback)(c.a.debounce(e=>{k({}),o({...s,search:e,page:1})},500),[]),T=e=>{"search"!==e.target.name?((e,a)=>{const t=e.target;let n=t.value;const l=t.name;if(e.target.files){let{files:a,multiple:t=!1}=e.target;t?(n=[],n=c.a.map(a,e=>({blob:window.URL.createObjectURL(e),binary:e,info:e.name,rest:{size:e.size,type:e.type}}))):((n={blob:"",binary:"",url:""}).blob=window.URL.createObjectURL(a[0]),n.binary=a[0],n.info=a[0]?a[0].name:"")}let r={name:l,value:n,type:e.target.type};"checkbox"===e.target.type&&(r.checked=e.target.checked),a(r)})(e,a=>{"file"!==a.name?(k({}),o({...s,[a.name]:a.value,page:1})):p(e.target.files)}):P(e.target.value)};Object(n.useEffect)(()=>{const{unsubscribe:e}=x(d.a.endpoints.getMediaRows.initiate(s));return()=>{e()}},[x,s]),Object(n.useEffect)(()=>{if(!(O||N||C)&&j){let e=w&&w.results?w.results:[];k({count:j.count,results:[...e,...j.results]})}},[j]),Object(n.useEffect)(()=>{if(b&&b.length){let e=w.count||0,a=w.results||[];k({count:e+b.length,results:[...b,...a]})}},[b]);const D=`${m.c.MEDIA_URL}/editor`;return l.a.createElement("div",{className:"mediaDialog-container","data-loading":f},l.a.createElement("div",{className:"mediaDialog-note"},"It is highly recommended to add image/s created by you. Please do not take any content from any other source to avoid any copyright issue."),l.a.createElement("div",{className:"mediaDialog-header"},l.a.createElement("div",{className:"mediaDialog-header__left"},l.a.createElement("form",null,l.a.createElement("div",{className:"inputGroup mr-2"},l.a.createElement("input",{onChange:T,placeholder:"Search by Name",name:"search",type:"text"}),l.a.createElement("button",{type:"button",className:"icon-btn secondary-button no-hover"},l.a.createElement("img",{src:`${D}/search.svg`,alt:"Media"}))),l.a.createElement("select",{name:"media_type",onChange:T,value:s.media_type,className:"mr-2"},l.a.createElement("option",{value:""},"Select Media Type"),h.a.map((e,a)=>l.a.createElement("option",{key:a,value:e.value},e.text))),a&&l.a.createElement("div",{className:"inputGroup mr-2"},l.a.createElement("input",{placeholder:"Embed Link",name:"embed_link",type:"text",ref:S}),l.a.createElement("button",{onClick:()=>{const e=S.current.value;if(""===e)return void alert("Please enter a link to embed");if(!/https:\/\/[a-z]*.geeksforgeeks.org/.test(e))return void alert("You can link only GeeksforGeeks content.");const a=["jpg","jpeg","png","gif"].includes(e.split(".").pop())?"image":"media";"image"===a?$.dispatchCommand(g.a,{src:e,media_type:a}):$.dispatchCommand(g.a,{url:e,media_type:a}),t()},type:"button",className:"icon-btn primary-button embed-btn no-hover"},l.a.createElement("span",null,"Embed"))))),l.a.createElement("div",{className:"mediaDialog-header__right"},e&&l.a.createElement(n.Fragment,null,l.a.createElement("button",{onClick:()=>i.click(),disabled:C||N||O,"data-position":"left",className:"icon-btn secondary-button"},l.a.createElement("img",{src:`${D}/media.svg`,alt:"Media"}),l.a.createElement("span",null,"Upload")),l.a.createElement("input",{accept:"video/*,image/*,audio/*",hidden:!0,type:"file",name:"file",id:"mediaFile",multiple:!0,ref:e=>i=e,onChange:T,onClick:e=>{e.target.value=null}})))),!f&&_&&l.a.createElement("div",{className:"mediaDialog-note py-1 error"},l.a.createElement("strong",null,"Error: "),l.a.createElement("div",{dangerouslySetInnerHTML:{__html:_}})),l.a.createElement(E,{data:w,isLoading:O,isFetching:N,isError:C,onClose:t}),!(O||N||C)&&j&&j.count>0&&20*(s.page||1)<j.count&&l.a.createElement("div",{style:{textAlign:"center"}},l.a.createElement("button",{className:"secondary-button secondary-button__sm",onClick:()=>o({...s,page:(s.page||1)+1})},"Load More")),l.a.createElement("div",{className:"loader"},l.a.createElement("span",null,"Uploading..")))};_.propTypes={enableUpload:s.PropTypes.bool,enableEmbedLink:s.PropTypes.bool,onClose:s.PropTypes.func};var w=_;a.default=(()=>{const{isEditable:e}=Object(n.useContext)(r.a),[a,t]=Object(i.a)();return l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{disabled:!e,onClick:()=>{t({contentFn:e=>l.a.createElement(w,{onClose:e}),size:"lg",isFloatingClose:!0})},className:"toolbar-item spaced"},l.a.createElement("i",{className:"editor-icon gfg-editor-image"})),a)})}}]);